<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">
<h:body>
	<ui:composition template="/WEB-INF/templates/layout.xhtml">
		<ui:define name="title">main</ui:define>

		<ui:define name="content">

			<h:form id="formMain">

				<p:layout>
					<p:layoutUnit id="leftPanel" position="west">
						<p:panel id="panel" header="Task List" class="max-width">
							<p:selectOneListbox id="tasksList" value="#{main.selectedTask}"
								converter="selectOneMenuConverter" var="t" filter="true"
								filterMatchMode="contains" class="margin-top20">
								
								<f:selectItems value="#{main.tasks}" var="task"	itemLabel="#{task.title}" itemValue="#{task}" />
								
								
								<p:commandLink id="ajax" update="growl" actionListener="#{buttonView.buttonAction}">
        <f:setPropertyActionListener value="#{task}" target="#{main.selectedTask}" />
    </p:commandLink>
								
								<p:column>
									<h:outputText styleClass="ui-theme ui-theme-task#{t.id}" value="#{t.title}" />
								</p:column>
							</p:selectOneListbox>
							<p:commandButton value="Add task" update="displayAddTask"
								onclick="PF('dlgAddTask').show()"
								class="margin-top20 max-width bottom blueGradient" >
							<f:setPropertyActionListener value="#{null}" target="#{task}" />
							</p:commandButton>
							<ui:remove>
							</ui:remove>
						
						</p:panel>
						
					</p:layoutUnit>
					<p:layoutUnit id="rightPanel" position="center">
						<p:dialog header="Dialog" modal="false" showEffect="blind" hideEffect="explode" widgetVar="dlgAddTask" resizable="false">
							<p:panelGrid columns="2" id="displayAddTask"
								columnClasses="label,output">

								<p:outputLabel for="newTitle" value="Task title" />
								<p:inputText id="newTitle" value="#{task.title}"></p:inputText>

								<p:outputLabel for="newDescription" value="Task description" />
								<p:inputTextarea id="newDescription" value="#{task.description}"
									rows="10" cols="50" counter="newDisplayTextArea"
									maxlength="256" counterTemplate="{0} characters remaining."
									autoResize="false">
									<h:outputText id="newDisplayTextArea" style="float:right;" />
								</p:inputTextarea>

								<p:outputLabel for="newDueDate" value="Due date" />
								<p:calendar value="#{task.dueDate}" id="newDueDate" />

								<p:commandButton process="@this" value="Save"
									action="#{main.save}"
									update="@([id$=saveMessage]) @([id$=tasksList])"
									class="margin-top20 max-width bottom blueGradient">
									<p:confirm header="Confirmation" message="Are you sure?"
										icon="ui-icon-alert" />
									<p:growl id="saveMessage" showDetail="true" />
								</p:commandButton>
								<p:commandButton value="Cancel" onclick="dlg.hide()" />

							</p:panelGrid>
						</p:dialog>

						<p:panel header="Task Details" class="max-width">
			<c:if test="#{main.selectedTask != null}">
							<h:panelGrid id="details" columns="1" class="max-width">
								<p:outputLabel for="title" value="Task title"
									class="margin-top20" />
								<p:inputText id="title" value="#{main.selectedTask.title}"
									class="max-width"></p:inputText>
								<p:outputLabel for="description" value="Task description"
									class="margin-top20" />
								<p:inputTextarea disabled="#{false}" id="description"
									value="#{main.selectedTask.description}" rows="10" cols="50"
									counter="displayTextArea" maxlength="256"
									counterTemplate="{0} characters remaining." autoResize="false"
									class="max-width" />
								<h:outputText id="displayTextArea" />
								<p:outputLabel for="dueDate" value="Due date"
									class="margin-top20" />
								<p:calendar id="dueDate" value="#{main.selectedTask.dueDate}"
									class="max-width" />

								<p:growl id="deleteMessage" showDetail="true" />
								<p:commandButton process="@this" value="Delete task"
									actionListener="#{main.delete}"
									update="@([id$=deleteMessage]) @([id$=tasksList])"
									class="margin-top20 max-width bottom blueGradient">
									<p:confirm header="Confirmation" message="Are you sure?"
										icon="ui-icon-alert" />
								</p:commandButton>

								<p:confirmDialog global="true" showEffect="fade"
									hideEffect="fade">
									<p:commandButton value="Yes" type="button"
										styleClass="ui-confirmdialog-yes" icon="ui-icon-check" />
									<p:commandButton value="No" type="button"
										styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
								</p:confirmDialog>

							</h:panelGrid>
            </c:if> 

						</p:panel>

					</p:layoutUnit>
				</p:layout>

			</h:form>

		</ui:define>

	</ui:composition>

</h:body>
</html>


